# 论如何科学地上课传纸条

## 0. 导论

众所周知，在较为无趣的~~历史政治音乐美术~~课上，传纸条都是重要的交流方式。

然鹅，这种方式有一个极大的劣势：容易在传递过程中受到拦截。而且光是拦截了还不要紧，关键是在纸条上传递的信息~~交流逃课经验~~要是被老师抓到了就不好了（x

于是，加密就这样华丽丽地出世了！

## 1. 太单纯啦！

为了剧情（雾）的连贯性，我们先称这两位同学为 Alice 和 Bob（密码学老常客了

在意识到纸条内容可能被老师阅读之后，Alice 同学率先想出了一个绝妙的办法：只要双方的发信息时，都将每个字母向后推一位就可以啦！例如：原句 "I'm fine, thanks, and you?" 就会被转换为 "J'n gjof, uibolt, boe zpv?"。

如果心情好，可以额外再多推几位，只要在消息开头标上推了几位就可以，比如 "7, P't mpul, aohurz, huk fvb?"。

这样，发送的消息在别人眼中都是乱码，只有~~靶细胞~~接收方知道要通过往回移动指定位数获得原本的消息。

~~于是乎又开始大肆传纸条。~~

但是，此时的 Alice 和 Bob 都太单纯了，老师作为钻研拦截纸条技术数十年的专家，只消看一眼，就知道这就是传说中的“凯撒密码”！名字听着很高大上，然而并没有什么卵用，仍然轻轻松松被老师破解了。。。。。。其实方法非常简单，就和 Bob 接收的方法一模一样（

## 2. 新发现！

在又被老师训了一顿后，Bob 痛定思痛，总结了上一次的失败经验。他发现，主要问题是解密用的信息（移动了几位）本身也需要写在明面上传过来，不然连~~受体~~接收方都看不懂了（

于是他下定决心苦苦钻研一种不需要这样做的加密方式，他想了很久。

很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久很久。

最终，功夫不负有心人，Bob 研发出来一种绝无仅有的新型炒鸡无敌霹雳爆炸人见人爱花见花开车见车爆胎加密大法，听好了，加密方式如下：

1. Alice 和 Bob 每人随机选一个很大的数，称之为  <img src="https://www.zhihu.com/equation?tex=k_a" alt="k_a" class="ee_img tr_noresize" eeimg="1">  和  <img src="https://www.zhihu.com/equation?tex=k_b" alt="k_b" class="ee_img tr_noresize" eeimg="1"> （不要跟化学的那个电离平衡系数搞混了）
2. Alice 随机再选一个数  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1"> ，并且在班里广播~~发表独立宣言~~说：“ <img src="https://www.zhihu.com/equation?tex=P=63872357536" alt="P=63872357536" class="ee_img tr_noresize" eeimg="1"> ” （这里 63872357536 代指 Alice 随机选的数）
3. 接下来，Alice 将  <img src="https://www.zhihu.com/equation?tex=k_a\times P" alt="k_a\times P" class="ee_img tr_noresize" eeimg="1">  得到  <img src="https://www.zhihu.com/equation?tex=R_a" alt="R_a" class="ee_img tr_noresize" eeimg="1">  并再次在班里广播~~扰民~~，Bob 将  <img src="https://www.zhihu.com/equation?tex=k_b\times P" alt="k_b\times P" class="ee_img tr_noresize" eeimg="1">  得到  <img src="https://www.zhihu.com/equation?tex=R_b" alt="R_b" class="ee_img tr_noresize" eeimg="1">  并且也在班里广播~~也是扰民~~。
4. 那么，现在 Alice 和 Bob 都可以计算出同一个数  <img src="https://www.zhihu.com/equation?tex=C = k_b \times R_a = k_a \times R_b" alt="C = k_b \times R_a = k_a \times R_b" class="ee_img tr_noresize" eeimg="1"> 。
5. 接下来就比较简单啦，比如说还是用上文的向后推字母的方式，但是改成第  <img src="https://www.zhihu.com/equation?tex=i" alt="i" class="ee_img tr_noresize" eeimg="1">  个字母向后推  <img src="https://www.zhihu.com/equation?tex=C" alt="C" class="ee_img tr_noresize" eeimg="1">  的第  <img src="https://www.zhihu.com/equation?tex=i" alt="i" class="ee_img tr_noresize" eeimg="1">  位的值的次数（这样的话每个字母向后推的次数不同，老师也就不知道怎么还原了，但是 Bob 知道  <img src="https://www.zhihu.com/equation?tex=C" alt="C" class="ee_img tr_noresize" eeimg="1">  的值，所以可以准确还原信息）

在你为这个充满了清澈的愚蠢的加密方式开怀大笑前，我需要先声明一下，Bob 还没有学乘除法（

那么，大家自然就会有一个疑问：Bob 是如何计算这么复杂的乘法的呢？

这就不得不提到 Bob 的（又一个）新发明，他称之曰“快速乘”。

首先，既然他不会乘法，那么把乘法写成  <img src="https://www.zhihu.com/equation?tex=k_a\times P" alt="k_a\times P" class="ee_img tr_noresize" eeimg="1">  的形式就是不合理的，正确的写法应该是  <img src="https://www.zhihu.com/equation?tex=\sum\limits_{i=1}^{k_a}P" alt="\sum\limits_{i=1}^{k_a}P" class="ee_img tr_noresize" eeimg="1"> ，也就是说，把  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1">  连加  <img src="https://www.zhihu.com/equation?tex=k_a" alt="k_a" class="ee_img tr_noresize" eeimg="1">  次。

那么，考虑这一系列加法： <img src="https://www.zhihu.com/equation?tex=2P=P+P" alt="2P=P+P" class="ee_img tr_noresize" eeimg="1"> ， <img src="https://www.zhihu.com/equation?tex=4P=2P+2P" alt="4P=2P+2P" class="ee_img tr_noresize" eeimg="1"> ， <img src="https://www.zhihu.com/equation?tex=8P=4P+4P" alt="8P=4P+4P" class="ee_img tr_noresize" eeimg="1"> ，......加的效率在不断提高！（加一次相当于加了很多次了）于是乎只要这样算乘法，就能比直接连加  <img src="https://www.zhihu.com/equation?tex=k_a-1" alt="k_a-1" class="ee_img tr_noresize" eeimg="1">  次要快很多了！

当然啦，Bob 只是“觉得”这样算乘法会比较快，但是上节课学过 『时间复杂度分析』之术的你则一定知道，这么计算的时间复杂度是  <img src="https://www.zhihu.com/equation?tex=\Theta(\log k_a)" alt="\Theta(\log k_a)" class="ee_img tr_noresize" eeimg="1"> 。读者自证不难，这里留作习题（雾

所以，有了快速乘秘诀的 Bob 自然可以轻松算出  <img src="https://www.zhihu.com/equation?tex=k_b\times P" alt="k_b\times P" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=k_b \times R_a" alt="k_b \times R_a" class="ee_img tr_noresize" eeimg="1">  之类的值了。

但他也知道，如果老师知道了  <img src="https://www.zhihu.com/equation?tex=k_a" alt="k_a" class="ee_img tr_noresize" eeimg="1">  和  <img src="https://www.zhihu.com/equation?tex=k_b" alt="k_b" class="ee_img tr_noresize" eeimg="1">  中的任何一个数，这个加密就会无效，毕竟这时老师也可以算出  <img src="https://www.zhihu.com/equation?tex=C = k_b \times R_a" alt="C = k_b \times R_a" class="ee_img tr_noresize" eeimg="1">  了。

那么他为什么不担心被破解呢？这是因为虽然乘法有“快速乘”，但是如果不会乘除法却要算“几乘以  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1">  等于  <img src="https://www.zhihu.com/equation?tex=R_a" alt="R_a" class="ee_img tr_noresize" eeimg="1"> ”的话，就真的得一个一个试了。作为现代人的我们知道， <img src="https://www.zhihu.com/equation?tex=\Theta(\log k_a)" alt="\Theta(\log k_a)" class="ee_img tr_noresize" eeimg="1">  的增长率是远小于  <img src="https://www.zhihu.com/equation?tex=\Theta(k_a)" alt="\Theta(k_a)" class="ee_img tr_noresize" eeimg="1">  的，所以 Bob 可以有恃无恐地不断增加  <img src="https://www.zhihu.com/equation?tex=k_a" alt="k_a" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=k_b" alt="k_b" class="ee_img tr_noresize" eeimg="1">  的大小，毕竟对自己的计算量没多大影响，~~却可以把老师算死~~。

......

然而 Bob 绝妙的加密方式被一个东西阻挡了。

__除法。__

## 3. 现在是我 Alice 的回合！

书接上回，Bob 研究出『新型炒鸡无敌霹雳爆炸人见人爱花见花开车见车爆胎加密大法』后，当天下午他就决定讲给 Alice 听。不料 Alice 曾在课外班提前学过乘除法，没等他讲完就绷不住了。

“有没有一种可能，自然数间的乘法有分配律和交换律？”，Alice 写下一串咒语：

设  <img src="https://www.zhihu.com/equation?tex=X \times P = R_a" alt="X \times P = R_a" class="ee_img tr_noresize" eeimg="1"> ， <img src="https://www.zhihu.com/equation?tex=X = \sum\limits_{i=0}^{l}x_i\times 10^i" alt="X = \sum\limits_{i=0}^{l}x_i\times 10^i" class="ee_img tr_noresize" eeimg="1"> ，其中  <img src="https://www.zhihu.com/equation?tex=\forall x_i, x_i\in [0,9]\cap\mathbb{N}" alt="\forall x_i, x_i\in [0,9]\cap\mathbb{N}" class="ee_img tr_noresize" eeimg="1"> 。

 <img src="https://www.zhihu.com/equation?tex=\because \forall i>0,x_{i}\times 10^{i} \times P>\sum\limits_{j=0}^{i-1}9\times 10^j \times P \ge\sum\limits_{j=0}^{i-1}x_j\times 10^j \times P" alt="\because \forall i>0,x_{i}\times 10^{i} \times P>\sum\limits_{j=0}^{i-1}9\times 10^j \times P \ge\sum\limits_{j=0}^{i-1}x_j\times 10^j \times P" class="ee_img tr_noresize" eeimg="1"> 。

 <img src="https://www.zhihu.com/equation?tex=\therefore" alt="\therefore" class="ee_img tr_noresize" eeimg="1">  每一个  <img src="https://www.zhihu.com/equation?tex=x_i" alt="x_i" class="ee_img tr_noresize" eeimg="1">  的值都不受之后数位的干扰，或者说  <img src="https://www.zhihu.com/equation?tex=0\le R_a-\sum\limits_{j=i+1}^{l}x_j\times 10^j\times P-x_{i}\times 10^{i} \times P\le\sum\limits_{j=0}^{i-1}9\times 10^j\times P" alt="0\le R_a-\sum\limits_{j=i+1}^{l}x_j\times 10^j\times P-x_{i}\times 10^{i} \times P\le\sum\limits_{j=0}^{i-1}9\times 10^j\times P" class="ee_img tr_noresize" eeimg="1"> 。这就意味着，可以考虑从最高位开始，在每一个  <img src="https://www.zhihu.com/equation?tex=x_i" alt="x_i" class="ee_img tr_noresize" eeimg="1">  上依次尝试  <img src="https://www.zhihu.com/equation?tex=[0,9]\cap\mathbb{N}" alt="[0,9]\cap\mathbb{N}" class="ee_img tr_noresize" eeimg="1">  的值直到满足不等式要求，从而在  <img src="https://www.zhihu.com/equation?tex=\Theta(l)" alt="\Theta(l)" class="ee_img tr_noresize" eeimg="1">  时间内求出  <img src="https://www.zhihu.com/equation?tex=X" alt="X" class="ee_img tr_noresize" eeimg="1">  的值。

“现在除法时间复杂度是  <img src="https://www.zhihu.com/equation?tex=\Theta(\log R_a)" alt="\Theta(\log R_a)" class="ee_img tr_noresize" eeimg="1">  了”，Alice 用这句话结束了讲解。

Bob 沉默了。他在深思。~~而且作者要求他在这段时间内赶紧学习一下什么是对数以保证剧情前后 Consistent。~~

在漫长的思考~~和学习复杂度分析~~后，Bob 再度开口道：“考虑到  <img src="https://www.zhihu.com/equation?tex=k_a\times P" alt="k_a\times P" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=k_a \times R_b" alt="k_a \times R_b" class="ee_img tr_noresize" eeimg="1">  的计算使用了快速乘后复杂度都是  <img src="https://www.zhihu.com/equation?tex=\Theta(\log k_a)" alt="\Theta(\log k_a)" class="ee_img tr_noresize" eeimg="1">  的，似乎如果把  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1">  改的很大就可以阻止  <img src="https://www.zhihu.com/equation?tex=\Theta(\log R_a)" alt="\Theta(\log R_a)" class="ee_img tr_noresize" eeimg="1">  的除法了”

Alice 向后靠了靠，轻推一下眼镜，说：“那是因为你计算时间复杂度的时候默认了加法是  <img src="https://www.zhihu.com/equation?tex=\Theta(1)" alt="\Theta(1)" class="ee_img tr_noresize" eeimg="1">  的操作，假如放任  <img src="https://www.zhihu.com/equation?tex=R_a" alt="R_a" class="ee_img tr_noresize" eeimg="1">  增大的话，快速乘的复杂度会随之膨胀至  <img src="https://www.zhihu.com/equation?tex=\Theta(\log R_a\log k_a)" alt="\Theta(\log R_a\log k_a)" class="ee_img tr_noresize" eeimg="1"> ，使得加密不可行。”

Bob 听罢，知道自己的方法已然无效，不由得掩面而泣。

Alice 正要起身，见 Bob 精神状态这么糟糕，安慰道：“但是你的思路还挺有价值的，我想想能不能改造改造。”

“真的吗？”

## 4. 其实这时 Alice 真正的回合才到

又是一天晚上，又有一只 Alice 在~~为了某个乱七八糟的承诺~~而在半夜做研究。

除法除法，为什么会有除法这个东西呢......

Alice 仔细思考，最终意识到了。之所以可以每一个  <img src="https://www.zhihu.com/equation?tex=x_i" alt="x_i" class="ee_img tr_noresize" eeimg="1">  的值都不受之后数位的干扰依次求解，就是因为自然数本身有一个明确的偏序关系，而且当他们同时乘以  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1">  的时候偏序关系不发生改变，使得  <img src="https://www.zhihu.com/equation?tex=0\le R_a-\sum\limits_{j=i+1}^{l}x_j\times 10^j\times P-x_{i}\times 10^{i} \times P\le\sum\limits_{j=0}^{i-1}9\times 10^j\times P" alt="0\le R_a-\sum\limits_{j=i+1}^{l}x_j\times 10^j\times P-x_{i}\times 10^{i} \times P\le\sum\limits_{j=0}^{i-1}9\times 10^j\times P" class="ee_img tr_noresize" eeimg="1">  得到保证。

换句话说，只要让  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1">  不再是一个越累加越多的类型就可以了......最好是个连偏序关系都没有的类型......

此时，Alice 恰好看向了自己无意在 desmos 中输入的一个椭圆曲线图像。

![](https://raw.githubusercontent.com/LincW0/Markdown4Zhihu/master/Data/20241017/graph1.png)

对了，直接让  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1">  是这个图像上的一个点（其集合）就可以了，毕竟肯定是没办法互相比大小了（

接下来就是要发明出一种新的加法，这样就可以在其基础上扩展出数乘。

Alice 认为，这种新的

一个简单的想法是，对于任意两点  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=Q" alt="Q" class="ee_img tr_noresize" eeimg="1"> ，定义其连线与椭圆曲线的第三个交点  <img src="https://www.zhihu.com/equation?tex=R:=P+Q" alt="R:=P+Q" class="ee_img tr_noresize" eeimg="1"> 。这样的定义显然满足交换律。

![](https://raw.githubusercontent.com/LincW0/Markdown4Zhihu/master/Data/20241017/graph2.png)

但这就导致了一个问题： <img src="https://www.zhihu.com/equation?tex=P+Q=R" alt="P+Q=R" class="ee_img tr_noresize" eeimg="1">  中  <img src="https://www.zhihu.com/equation?tex=R" alt="R" class="ee_img tr_noresize" eeimg="1">  的地位与  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1">  和  <img src="https://www.zhihu.com/equation?tex=Q" alt="Q" class="ee_img tr_noresize" eeimg="1">  不同了，但在图像上 <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=Q" alt="Q" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=R" alt="R" class="ee_img tr_noresize" eeimg="1">  是轮换对称的，所以有  <img src="https://www.zhihu.com/equation?tex=P+R=Q" alt="P+R=Q" class="ee_img tr_noresize" eeimg="1"> ， <img src="https://www.zhihu.com/equation?tex=R+Q=P" alt="R+Q=P" class="ee_img tr_noresize" eeimg="1"> ，进而能推出  <img src="https://www.zhihu.com/equation?tex=P+P+R=R" alt="P+P+R=R" class="ee_img tr_noresize" eeimg="1">  之类的结论，加法直接彻底崩坏了。

为了使  <img src="https://www.zhihu.com/equation?tex=P" alt="P" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=Q" alt="Q" class="ee_img tr_noresize" eeimg="1"> 、 <img src="https://www.zhihu.com/equation?tex=R" alt="R" class="ee_img tr_noresize" eeimg="1">  在加法的定义式中也是地位平等的，试图改为定义  <img src="https://www.zhihu.com/equation?tex=P+Q=-R" alt="P+Q=-R" class="ee_img tr_noresize" eeimg="1"> 。

其中，一个点的逆  <img src="https://www.zhihu.com/equation?tex=-R" alt="-R" class="ee_img tr_noresize" eeimg="1">  被定义为这个点关于横轴的对称点，这样可以保证任意的点  <img src="https://www.zhihu.com/equation?tex=R" alt="R" class="ee_img tr_noresize" eeimg="1">  都有一个确定的逆。

